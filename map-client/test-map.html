<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map Click Test</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB6-shv9yZ-TePQmbXUTiewlRUIe2Y-AAo&libraries=places" async defer></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #map {
            width: 100%;
            height: 400px;
            border: 2px solid #ccc;
        }
        #log {
            margin-top: 20px;
            padding: 10px;
            background: #f5f5f5;
            border: 1px solid #ddd;
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Map Click Test</h1>
    <p>Click on the map to test if click events are working:</p>
    
    <div id="map"></div>
    
    <div style="margin: 20px 0;">
        <button onclick="enableLocationMode('pickup')">Enable Pickup Mode</button>
        <button onclick="enableLocationMode('destination')">Enable Destination Mode</button>
        <button onclick="disableLocationMode()">Disable Location Mode</button>
        <button onclick="clearLog()">Clear Log</button>
    </div>
    
    <div id="log"></div>

    <script>
        let map;
        let tempMarker = null;
        let isLocationSelectionMode = false;
        let currentLocationType = null;

        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}<br>`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(message);
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        function enableLocationMode(type) {
            isLocationSelectionMode = true;
            currentLocationType = type;
            log(`‚úÖ Location mode enabled: ${type}`);
        }

        function disableLocationMode() {
            isLocationSelectionMode = false;
            currentLocationType = null;
            if (tempMarker) {
                tempMarker.setMap(null);
                tempMarker = null;
            }
            log(`‚ùå Location mode disabled`);
        }

        function initMap() {
            log('Initializing map...');
            
            const defaultLocation = { lat: 20.5937, lng: 78.9629 }; // India center
            
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 10,
                center: defaultLocation,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            });
            
            log('Map created successfully');
            
            // Add click listener
            map.addListener('click', function(event) {
                log(`üîç MAP CLICK: ${event.latLng.lat()}, ${event.latLng.lng()}`);
                log(`Location mode: ${isLocationSelectionMode}, Type: ${currentLocationType}`);
                
                if (isLocationSelectionMode) {
                    log('‚úÖ Creating temp marker...');
                    
                    // Remove existing temp marker
                    if (tempMarker) {
                        tempMarker.setMap(null);
                        log('üóëÔ∏è Removed previous temp marker');
                    }
                    
                    // Create new temp marker
                    tempMarker = new google.maps.Marker({
                        position: event.latLng,
                        map: map,
                        title: `${currentLocationType} location`,
                        icon: {
                            url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
                                <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="15" cy="15" r="12" fill="#FFD700" stroke="white" stroke-width="3"/>
                                    <text x="15" y="20" text-anchor="middle" fill="white" font-size="14" font-weight="bold">T</text>
                                </svg>
                            `),
                            scaledSize: new google.maps.Size(30, 30),
                            anchor: new google.maps.Point(15, 15)
                        }
                    });
                    
                    log(`‚úÖ Temp marker created: ${tempMarker ? 'SUCCESS' : 'FAILED'}`);
                    log(`Marker position: ${tempMarker.getPosition().lat()}, ${tempMarker.getPosition().lng()}`);
                } else {
                    log('‚ÑπÔ∏è Location mode not active - click buttons above to enable');
                }
            });
            
            log('Map click listener added');
            log('üéØ Ready! Click on the map to test...');
        }

        // Initialize map when Google Maps API loads
        window.initMap = initMap;
    </script>
</body>
</html> 